# Финальное решение проблемы с токеном VK для закрытой группы

## Ситуация:
- Группа `tennisprimesport` стала закрытой
- Вы не администратор группы (не можете получить токен сообщества)
- Токены формата `vk1.a.` - это новый формат VK ID

## Решение: Использовать токен пользователя-участника группы

### Важно:
Если вы **участник** закрытой группы, токен пользователя через OAuth должен работать для `wall.get`.

### Шаг 1: Проверьте, что вы участник группы

1. Откройте https://vk.com/tennisprimesport
2. Убедитесь, что вы подписаны на группу (если нет - подпишитесь)

### Шаг 2: Получите токен через OAuth (уже сделано)

Токен формата `vk1.a.` - это нормально, это новый формат VK. Проверьте, работает ли он:

```bash
# На сервере
cd /root/s360-streams
git pull origin main

# Откройте test_vk1_token.py и вставьте полный токен из URL
nano test_vk1_token.py
# Замените NEW_TOKEN на полный токен (весь токен из URL, начинается с vk1.a.)

# Проверьте токен
python3 test_vk1_token.py
```

### Шаг 3: Если токен работает - обновите на сервере

```bash
nano /root/s360-streams/.env
# Замените VK_TOKEN= на токен формата vk1.a.
VK_TOKEN=vk1.a.полный_токен_здесь

systemctl restart vk-to-telegram.service
tail -n 20 /root/s360-streams/vk_to_telegram.log
```

### Шаг 4: Если токен не работает

Возможные причины:
1. **Привязка к IP** - токен получен с другого IP. Решение: получить токен с IP сервера или использовать прокси
2. **Недостаточно прав** - токен не имеет прав `wall,groups`. Решение: получить токен с правильными правами
3. **Группа слишком закрытая** - даже участники не могут читать через API. Решение: дождаться, пока группа снова станет публичной

## Альтернатива: Дождаться, пока группа снова станет публичной

Если группа временно закрыта, можно просто подождать. Когда группа снова станет публичной, старый токен из CONFIG.txt должен заработать.

## Важно:

- Токен формата `vk1.a.` - это нормально, это новый формат VK
- Для закрытой группы нужен токен пользователя-участника
- Токен должен быть получен с правильными правами: `wall,groups`
