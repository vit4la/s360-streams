# Исправление ошибки VK API 15 для публичной группы

## Проблема
Ошибка: `Access denied: this wall available only for community members` (код 15)

**ВАЖНО:** Мы парсим публичную группу, не являемся администраторами!

## Возможные причины:

1. **Группа стала приватной/закрытой** - проверьте https://vk.com/tennisprimesport
2. **Токен истек** - токены VK обычно действуют 24 часа (если не указан `offline`)
3. **Токен недействителен** - возможно, был отозван

## Решение:

### Шаг 1: Проверьте группу

Откройте https://vk.com/tennisprimesport
- Если группа **публичная** - продолжайте
- Если группа **приватная/закрытая** - это проблема группы, не токена. Нужно ждать, пока группа снова станет публичной.

### Шаг 2: Получите новый токен (для публичной группы)

Для чтения публичной стены нужен просто токен пользователя с правами `wall`, `groups` (не обязательно быть администратором).

**Через браузер:**

1. Войдите в VK (любой аккаунт, не обязательно администратор группы)
2. Откройте в браузере:
   ```
   https://oauth.vk.com/authorize?client_id=1&display=page&redirect_uri=https://oauth.vk.com/blank.html&scope=wall,groups,offline&response_type=token&v=5.199
   ```
   
   **Важно:** Добавлен `offline` в scope, чтобы токен не истекал через 24 часа.

3. Нажмите "Разрешить"
4. После перенаправления скопируйте `access_token` из URL:
   ```
   https://oauth.vk.com/blank.html#access_token=ВАШ_ТОКЕН&expires_in=0&user_id=123456
   ```
   - `expires_in=0` означает, что токен бессрочный (благодаря `offline`)

### Шаг 3: Обновите токен на сервере

```bash
# На сервере
nano /root/s360-streams/.env

# Найдите строку VK_TOKEN= и замените значение
VK_TOKEN=ваш_новый_токен_здесь

# Сохраните (Ctrl+O, Enter, Ctrl+X)
```

### Шаг 4: Перезапустите сервис

```bash
systemctl restart vk-to-telegram.service
tail -n 20 /root/s360-streams/vk_to_telegram.log
```

### Шаг 5: Проверьте работу

```bash
python3 check_vk_service.py
```

Если в разделе "4. ПРОВЕРКА VK API" появится "✅ VK API работает", проблема решена.

## Если группа стала приватной:

Если группа `tennisprimesport` стала приватной/закрытой, то:
- Токен здесь не поможет
- Нужно ждать, пока группа снова станет публичной
- Или найти другую публичную группу с трансляциями
